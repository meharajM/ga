Index: components/filter.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><script src=\"./js/bootstrap-datepicker.min.js\"></script>\n<div class=\"bg-light border\">\n    <div class=\"text-center pt-2 pb-1 mt-2 mb-2\">\n                    <div class=\"fa fa-angle-left prev\"  id=\"previous_day\"></div>\n                    <input id=\"date\" name=\"date\" type=\"text\" style=\"text-align:center\"/>\n                    <div class=\"fa fa-angle-right next\" id=\"next_day\">\n                    </div>\n\n    </div>\n        <div class=\"row\tmt-2 mb-2 pt-2 pb-1\">\n            <div class=\"col-sm-12 text-center\">\n                <div class=\"filter-area\">\n                    <div class=\"btn-group btn-group-sm\" data-toggle=\"buttons\">\n                        <label class=\"all-button btn btn-light active\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_1\" value=\"all\" id=\"all\" autocomplete=\"off\" checked=\"checked\">All<sup><span id=\"all_button\"></span></sup>\n                        </label>\n                        <label class=\"pending-button btn btn-light\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_1\" value=\"booked\" id=\"pending\" autocomplete=\"off\">Pending<sup><span id=\"pending_button\"></span></sup>\n                        </label>\n                        <label class=\"closed-button btn btn-light\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_1\" value=\"closed\" id=\"closed\" autocomplete=\"off\">Closed<sup><span id=\"closed_button\"></span></sup>\n                        </label>\n                    </div>\n\n                    <div class=\"btn-group btn-group-sm\" data-toggle=\"buttons\">\n                        <label class=\"btn btn-light active\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_2\" value=\"all_filter_2\" id=\"all_filter_2\" autocomplete=\"off\"  checked=\"checked\">All\n                        </label>\n                        <label class=\"btn btn-light\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_2\" value=\"VC\" id=\"video1\" autocomplete=\"off\" ><i class=\"fa fa-video-camera\"></i>\n                        </label>\n                        <label class=\"btn btn-light\">\n                            <input class='filter-btn' type=\"radio\" name=\"filter_2\" value=\"PC\" id=\"physical1\" autocomplete=\"off\"><i class=\"fa fa-user\"></i>\n                        </label>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n</div>\n\n<script>\n    $(document).ready(function () {\n        var filter1, filter2;\n        $('.filter-btn').on('change',  function(ev){\n            if( 'all' == ev.target.value){\n                filter1 = undefined;\n            }else if('all_filter_2'==ev.target.value) {\n                filter2= undefined;\n            }\n\n            if(ev.target.name == 'filter_1' && 'all' != ev.target.value){\n                filter1  = ev.target.value;\n            }else if(ev.target.name == 'filter_2' && 'all_filter_2'!=ev.target.value){\n                filter2 = ev.target.value;\n            }\n            var filteredAppointments = appointment_list.filter(function(val) {\n                if(filter1 && filter2){\n                    return val.appointment_status == filter1 && val.appointment_type == filter2;\n                }else if(filter1){\n                    return val.appointment_status == filter1;\n                }else if(filter2){\n                    return val.appointment_type == filter2;\n                }else {\n                    return true;\n                }\n            });\n            showDashboardDetails({appointments_details: {appointment: filteredAppointments}}    );\n        });\n            $(\"#date\").datepicker({\n            format: 'DD, M d, yyyy',\n\t        changeMonth: true,\n            changeYear: true,\n            minDate: 0,\n            todayHighlight: true,\n            autoclose: true\n        }).on('changeDate', function(e) {\n                var actualDate = e.date;\n                //  var new_date=moment(actualDate).format(\"dddd MMM Do YY\");\n                // alert(new_date);\n                $(\"#date\").val(moment(actualDate).format(\"dddd, ll\"));\n           //     appointment_date= document.getElementById(\"date\").html=moment(date).format(\"DD-MM-YYYY\");\n                // alert($(\"#date\").val(new_date));\n                var date = moment(actualDate).format(\"YYYYMMDD\");\n                getData.getDashboardData(date).then(function (res) {\n                    appointment_list = res.appointments_details.appointment;\n                    showDashboardDetails(res);\n                    appointment_date=moment(actualDate).format(\"YYYY-MM-DD\");\n                   // alert(appointment_date);\n\n                });\n            });\n\n         $(function () {\n            // This writes out the current date to the text field as starter\n            $('#date').val(moment().format(\"dddd, ll\"));\n//             appointment_date= document.getElementById(\"date\").html=moment(date).format(\"DD-MM-YYYY\");\n  //           $(\".filter-area\").hide();\n\n            // Hook up previous button event\n            $('#previous_day').click(function () {\n                // Set our current date to 1 day earlier\n               // current_date.setDate(current_date.getDate() - 1);\n                // Write the result to our text input\n              //  $('#date').val(current_date.toLocaleDateString('en-US', options));\n             //   var actualDate = new Date(current_date); // convert to actual date;\n                if(prev_apmt_date) {\n                    var date = prev_apmt_date;\n                    getData.getDashboardData(date).then(function (res) {\n                        appointment_list = res.appointments_details.appointment;\n                        appointment_date=moment(prev_apmt_date).format(\"YYYY-MM-DD\");\n                      //  alert(appointment_date);\n                        showDashboardDetails(res);\n                        $(\"#date\").val(moment(date).format(\"dddd, ll\"));\n                        $(\".filter-area\").show();\n                        $('.appointment-info').removeClass('d-none');\n                        $('#appointment-list').removeClass('d-none');\n                        $('.no-appointment-selected').addClass('d-none');\n                    })\n                }else{\n                    $(\"#date\").val(\"No Previous Appointments\");\n                    $('.appointment-info').addClass('d-none');\n                    $('#appointment-list').addClass('d-none');\n                    $('.no-appointment-selected').removeClass('d-none');\n                    $(\".filter-area\").addClass('d-none');\n                }\n            });\n            // Hook up next button event\n            $('#next_day').click(function () {\n                // Set our current date to 1 day later\n               // current_date.setDate(current_date.getDate() + 1);\n                // Write the result to our text input\n               // $('#date').val(current_date.toLocaleDateString('en-US', options));\n             //   var actualDate = new Date(current_date); // convert to actual date;\n                if(next_apmt_date) {\n                    var date = next_apmt_date;\n                    getData.getDashboardData(date).then(function (res) {\n                        appointment_list = res.appointments_details.appointment;\n                        appointment_date=moment(next_apmt_date).format(\"YYYY-MM-DD\");\n                       // alert(appointment_date);\n\n                        showDashboardDetails(res);\n                        $(\"#date\").val(moment(date).format(\"dddd, ll\"));\n                        $(\".filter-area\").show();\n                        $('.appointment-info').removeClass('d-none');\n                        $('#appointment-list').removeClass('d-none');\n                        $('.no-appointment-selected').addClass('d-none');\n                    })\n                }else\n                {\n                    $(\"#date\").val(\"No Next Appointments\");\n                    $('.appointment-info').addClass('d-none');\n                    $('#appointment-list').addClass('d-none');\n                    $('.no-appointment-selected').removeClass('d-none');\n                    $(\".filter-area\").hide();\n\n                }\n            });\n        });\n    })\n</script>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- components/filter.html	(date 1513434876000)
+++ components/filter.html	(date 1513435276000)
@@ -11,11 +11,11 @@
             <div class="col-sm-12 text-center">
                 <div class="filter-area">
                     <div class="btn-group btn-group-sm" data-toggle="buttons">
-                        <label class="all-button btn btn-light active">
+                        <label class="all-button btn btn-light ">
                             <input class='filter-btn' type="radio" name="filter_1" value="all" id="all" autocomplete="off" checked="checked">All<sup><span id="all_button"></span></sup>
                         </label>
-                        <label class="pending-button btn btn-light">
-                            <input class='filter-btn' type="radio" name="filter_1" value="booked" id="pending" autocomplete="off">Pending<sup><span id="pending_button"></span></sup>
+                        <label class="pending-button btn btn-light active">
+                            <input class='filter-btn' type="radio" name="filter_1" value="booked" id="pending" autocomplete="off" checked="checked">Pending<sup><span id="pending_button"></span></sup>
                         </label>
                         <label class="closed-button btn btn-light">
                             <input class='filter-btn' type="radio" name="filter_1" value="closed" id="closed" autocomplete="off">Closed<sup><span id="closed_button"></span></sup>
@@ -42,9 +42,8 @@
 
 <script>
     $(document).ready(function () {
-        var filter1, filter2;
         $('.filter-btn').on('change',  function(ev){
-            if( 'all' == ev.target.value){
+            if( 'all' == ev.target.value){// filters are defined in dashboard.js
                 filter1 = undefined;
             }else if('all_filter_2'==ev.target.value) {
                 filter2= undefined;
Index: components/prescription.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!--<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js\"></script>-->\n<script  type=\"text/x-handlebars-template\" id=\"prescriptiontable\">\n\t{{#prescription}}\n\t<tr>\n\t\t<td>{{med_type}}</td>\n\t\t<td>{{med_name}}</td>\n\t\t<td>{{frequency_string}}</td>\n\t\t<td>{{course}}</td>\n\t\t<td>{{med_intake}}</td>\n\t\t<td>{{remarks}}</td>\n\t\t<td>\n\t\t\t<span class=\"edit\" id=\"e_{{prescription_id}}\"><i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i></span>\n\t\t\t<span class=\"delete\" id=\"d_{{prescription_id}}\"><i class=\"fa fa-trash-o fa-fw\" aria-hidden=\"true\"></i></span>\n\t\t</td>\n\t</tr>\n\t{{/prescription}}\n</script>\n<div class=\"col-xs-12 appointment-details\">\n\t<div class=\"form\">\n\t\t<form id=\"form3\" method=\"post\">\n\t\t\t<div class=\"form-group\">\n\n\t\t\t\t<div class=\"col-2 pull-right\">\n\t\t\t\t\t<button type=\"button\" class=\"close\" id=\"pres_close\" aria-label=\"Close\">\n\t\t\t\t\t\t<span id=\"close-button\" aria-hidden=\"true\"><h3>&times;</h3></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-2\">\n\t\t\t\t\t<select class=\"custom-select form-control form-control-sm\" id=\"med_type\" name=\"med_type\" required>\n\t\t\t\t\t\t<option value=\"Pills\">Pills</option>\n\t\t\t\t\t\t<option value=\"Injection\">Injection</option>\n\t\t\t\t\t\t<option value=\"Syrup\">Syrup</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-8\">\n\t\t\t\t\t<div class=\"ui-front\">\n\t\t\t\t\t\t<input class=\"form-input\" name=\"med_search\" id=\"med_search\" placeholder=\"medecin name *\" required>\n\n\t\t\t\t\t\t</input>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\n\t\t\t</div>\n\n\n\t\t\t<div class=\"timings mt-3\">\n\t\t\t\t<ul class=\"nav nav-tabs\">\n\t\t\t\t\t<li><a href=\"#\" id=\"standard\" class=\"selected\">Standard</a></li>\n\t\t\t\t\t<li><a href=\"#\" id=\"free-text\">Free Text</a></li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div id=\"standard-tab\">\n\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t<div class=\"col-2\">\n\t\t\t\t\t\t\t<div class=\"font-12\">Morning *</div>\n\t\t\t\t\t\t\t<i class=\"fa fa-plus\" aria-hidden=\"true\" for=\"morning\"></i>\n\t\t\t\t\t\t\t\t<input type=\"number\" name=\"morning\" id=\"morning\"  class=\"quantity form-input\" value=\"0\" min=\"0\">\n\t\t\t\t\t\t\t<i class=\"fa fa-minus\" aria-hidden=\"true\" for=\"morning\"></i>\n\t\t\t\t\t\t\t<span class=\"unit\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"col-2\">\n\t\t\t\t\t\t\t<div class=\"font-12\">Afternoon *</div>\n\t\t\t\t\t\t\t<i class=\"fa fa-plus\" aria-hidden=\"true\" for=\"afternoon\"></i>\n\t\t\t\t\t\t\t<input type=\"number\" name=\"afternoon\" id=\"afternoon\" placeholder=\"Afternoon\" class=\"quantity form-input\" value=\"0\" min=\"0\">\n\t\t\t\t\t\t\t<i class=\"fa fa-minus\" aria-hidden=\"true\" for=\"afternoon\"></i>\n\t\t\t\t\t\t\t<span class=\"unit\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"col-2\">\n\t\t\t\t\t\t\t<div class=\"font-12\">Night *</div>\n\t\t\t\t\t\t\t<i class=\"fa fa-plus\" aria-hidden=\"true\" for=\"evening\"></i>\n\t\t\t\t\t\t\t<input type=\"number\" name=\"night\" id=\"evening\" placeholder=\"Night\" class=\"quantity form-input\" value=\"0\" min=\"0\">\n\t\t\t\t\t\t\t<i class=\"fa fa-minus\" aria-hidden=\"true\" for=\"evening\"></i>\n\t\t\t\t\t\t\t<span class=\"unit\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"col-sm-4 food\">\n\t\t\t\t\t\t\t<label class=\"custom-control custom-radio\">\n\t\t\t\t\t\t\t\t<input id=\"before-food\" name=\"med_intake\" type=\"radio\" value=\"Before Food\"  class=\"custom-control-input\">\n\t\t\t\t\t\t\t\t<span class=\"custom-control-indicator\"></span>\n\t\t\t\t\t\t\t\t<span class=\"custom-control-description\">Before Food</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<label class=\"custom-control custom-radio\">\n\t\t\t\t\t\t\t\t<input id=\"after-food\" name=\"med_intake\" type=\"radio\" value=\"After Food\" class=\"custom-control-input\">\n\t\t\t\t\t\t\t\t<span class=\"custom-control-indicator\"></span>\n\t\t\t\t\t\t\t\t<span class=\"custom-control-description\">After Food</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"free-text-tab\">\n\t\t\t\t\t<textarea name=\"med_dosage_text\" id=\"timings-text\" rows=\"3\" placeholder=\"Provide the timings details.\"/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\tSuggestions: <span id=\"suggestions\"><a href=\"#\">For Every 3 hours</a>, <a  href=\"#\">7:30 AM - 10:30 AM - 1:30 PM - 4:30 PM</a></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group row mt-3\">\n\n\t\t\t\t<div class=\"col-sm-3\">\n\t\t\t\t\t<input type=\"number\" name=\"course\" placeholder=\"Duration *\" min=0 class=\"form-input\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-sm-4 duration\">\n\t\t\t\t\t<label class=\"custom-control custom-radio\">\n\t\t\t\t\t\t<input id=\"days\" name=\"duration\" type=\"radio\" value=\"days\" class=\"custom-control-input\">\n\t\t\t\t\t\t<span class=\"custom-control-indicator\"></span>\n\t\t\t\t\t\t<span class=\"custom-control-description\">Days</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label class=\"custom-control custom-radio\">\n\t\t\t\t\t\t<input id=\"weeks\" name=\"duration\" type=\"radio\" value='weeks' class=\"custom-control-input\">\n\t\t\t\t\t\t<span class=\"custom-control-indicator\"></span>\n\t\t\t\t\t\t<span class=\"custom-control-description\">Weeks</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label class=\"custom-control custom-radio\">\n\t\t\t\t\t\t<input id=\"months\" name=\"duration\" type=\"radio\" value='months' class=\"custom-control-input\">\n\t\t\t\t\t\t<span class=\"custom-control-indicator\"></span>\n\t\t\t\t\t\t<span class=\"custom-control-description\">Months</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<textarea class=\"form-control\" id=\"exampleTextarea\" name=\"remarks\" placeholder=\"remarks...\" rows=\"3\"></textarea>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group rows\">\n\t\t\t\t<button class=\"btn btn-success btn-sm\" id=\"add-prescription\">Add</button> <span class=\"form-error hidden-xs-up\">Please add all mandatory fields</span>\n\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t<hr/>\n\t<div>\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col-7\">\n\t\t\t\t<b>Prescribed Medications</b>\n\t\t\t</div>\n\t\t\t<div class=\"col-3 pull-right\">\n\t\t\t\t<select class=\"template_name form-control\" name=\"template_name\" id=\"template_name\">\t</select>\n\t\t\t</div>\n\t\t\t<div class=\"col-1\">\n\t\t\t\t<div id=\"add\" class=\"btn btn-default fa fa-plus float-right btn-primary btn-sm\"></div>\n\t\t\t</div>\n\t\t</div>\n\n\n\t\t<table class=\"table table-sm prescriptions-table\">\n\t\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th><b>Type</b></th>\n\t\t\t\t<th><b>Name</b></th>\n\t\t\t\t<th><b>Timings/Quantity</b></th>\n\t\t\t\t<th><b>Course Duration</b></th>\n\t\t\t\t<th><b>Medicine Intake</b></th>\n\t\t\t\t<th><b>Instructions</b></th>\n\t\t\t\t<th id=\"strong\"><b>Action</b></th>\n\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody id=\"tab1\">\n\t\t\t<tr >\n\t\t\t\t<td>\n\t\t\t\t\tPlease add Prescriptions.\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t</tbody>\n\t\t</table>\n\t\t<button class=\"btn btn-primary btn-sm\" id=\"save_continue\">Save & Continue</button>\n\t</div>\n\n</div>\n<div class=\"template modal fade bd-example-modal-lg\" id=\"template-alert\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n        <div class=\"template-msg modal-dialog modal-sm\" role=\"document\">\n            <div class=\" modal-content\">\n                <div class=\"modal-header\">\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                        <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                    <h4 class=\"modal-title\">Template</h4>\n                </div>\n                <div class=\"modal-body-template\">\n                Do you want to replace the existing medicines or append it?\n                </div>\n                <div class=\"modal-footer text-center\">\n                    <button type=\"button\" class=\"btn btn-info btn-sm\" id=\"replace\" data-dismiss=\"modal\" >Replace</button>\n                    <button type=\"button\" class=\"btn btn-primary btn-sm\" id=\"append\" data-dismiss=\"modal\" >Append</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n<script type=\"text/javascript\">\n\tvar prescription = {}\n    $(document).ready(function() {\n        var prescription_data = [];\n        function setUnit() {\n            switch($('#med_type').val().toLowerCase()){\n                case \"pills\":\n                    prescription.unit = 'tabs';\n                    prescription.baseQuantity = 0.5;\n                    $('.unit').html('tabs');\n                    $('.quantity').prop(\"min\", 0.5);\n                    break;\n                case \"syrup\":\n                    prescription.unit = 'ml';\n                    prescription.baseQuantity = 1;\n                    $('.unit').html('ml');\n                    $('.quantity').prop(\"min\", 1);\n                    break;\n\t\t\t\tdefault:\n                    prescription.unit = '';\n                    $('.unit').html('');\n                    break;\n            }\n        }\n        setUnit();\n\t\t$('#med_type').on('change',function (ev) {\n\t\t\tsetUnit();\n        })\n        $(\"#template_name\").select2({\n            width: '200px',\n            tags: true,\n            placeholder: \"Search for a template\",\n            allowClear: true,\n            containerCssClass : \"custom-select \",\n            ajax: { // instead of writing the function to execute the request we use Select2's convenient helper\n                type: \"post\",\n                url: base_url+\"/api/getPrescriptionTemplateList.php\",\n                dataType: 'json',\n           //     contentType: 'application/json; charset=UTF-8',\n                quietMillis: 250,\n                data: function (term) {\n                    return JSON.stringify({\n                        template_input : {\n                        \tdoctor_id: doctor_id,\n                          \t//doctor_id: 1,\n                            template_id: 1,\n                            template_name:term.term,\n                            speciality: \"\"\n                        }\n                    })\n                },\n                processResults: function (data) { // parse the results into the format expected by Select2.\n                    // since we are using custom formatting functions we do not need to alter the remote JSON data\n\n                    return {\n                        results: $.map(data.template_det, function (smthg) {\n                           return {id: smthg.template_id, text: smthg.template_name}\n                        })\n                    };\n                }\n            },\n            cache: true\n\t\t}).addClass('custom-select ');\n\n        $('#template_name').on('select2:select', function (e) {\n            var template_id = $(this).val();\n              var template_name=$(\"#template_name\").text();         \n            \n            getData.getMyprescriptionTemplateDetails(template_id).then(function (res) {\n             \n                $(\".modal-header\").html(template_name);\n                $('#template-alert').modal({\n                    show: true\n                });\n                $(\"#replace\").on(\"click\", function (evt) {\n                    showPrescriptions(res.prescription_details);\n                    evt.preventDefault();\n                });\n                $(\"#append\").on(\"click\", function (evt) {\n                    //  var prev_data = showPrescriptions(res.prescription_details);\n                    getData.getMyprescriptionTemplateDetails(template_id).then(function (res) {\n                    debugger\n                    prescription_data =prescription_data.concat(res.prescription_details);\n                    showPrescriptions(prescription_data);\n                });\n                evt.preventDefault();\n                });\n\n            });\n        });\n\n/*  Code start for append and replace  */\n\n        \n    \n\n\n\n/*  code end here for append and replace  */\n        $(\"#med_search\").autocomplete({\n            minLength: 3,\n            placeholder: \"Search for a template\",\n            allowClear: true,\n            classes: {\n                \"ui-autocomplete\": \"menu\"\n            },\n            source: function(req, response){\n                getData.getMymedicineList(req.term).then(function(res){\n                    response(res.my_medicine.map(function (t) { return {label:t.med_brand_name, id:t.med_id} }));\n                });;\n            }\n        });\n\n        $(\"select\").on(\"select2:select\", function (evt) {\n            var element = evt.params.data.element;\n            var $element = $(element);\n\n            $element.detach();\n            $(this).append($element);\n            $(this).trigger(\"change\");\n        });\n        $('#med_search').change(function(){\n            var med_name = $('#med_search').val();\n            $(\"#med_name\").val=med_name;\n          // alert(\"med name:\"+med_name);\n        });\n\n        if (prescriptions_list) {\n            prescription_data = prescriptions_list;\n        }\n        $('.form').hide();\n        $('#add').on('click', function (ev) {\n            $(\"#form3\").get(0).reset();\n            $('.form').show();\n            ev.stopPropagation();\n        });\n        $(\"#close-button\").on('click', function (ev) {\n            $('.form').hide();\n            $(\"#form3\").get(0).reset();\n            $(\"#med_name\").val(\"\");\n            ev.stopPropagation();\n        })\n        var showPrescriptions = function (prescriptions_list) {\n            prescription_data = prescriptions_list;\n            var source = $(\"#prescriptiontable\").html();\n            var template = Handlebars.compile(source);\n            var rows = prescriptions_list.map(function (data) {\n                if (!data.delete_flag || data.delete_flag != 'Y') {\n                    if(!!data.med_id){\n                        data.prescription_id = data.med_id;\n                    }\n                    return template({prescription: data});\n                }\n                //alert(({prescription:data}));\n            });\n            $('#tab1').html(rows.join(''));\n        };\n        if (apmt_status == \"closed\") {\n            $(\"#add\").hide();\n            $(\"#save_continue\").hide();\n            $(\"#strong\").hide();\n            $(\".edit\").hide();\n            $(\".delete\").hide();\n            $('#template_name').hide();\n        }\n        //  $(\"#form4\").hide()\n        showPrescriptions(prescription_data);\n        function validateForm(formData){\n            var isValid = true;\n            $('.form-error').addClass('hidden-xs-up')\n            $('#med_search').removeClass('error');\n           if(formData['med_name'] == \"\"){\n               $('#med_search').addClass('error');\n               isValid =false;\n           }\n           $('#med_type').removeClass('error');\n            $('.quantity').removeClass('error');\n            $('#timings-text').removeClass('error');\n\n            if(formData['frequency_type'] == \"std_MAE\" && formData['frequency_string'] == \"0-0-0\"){\n                $('.quantity').addClass('error');\n                isValid = false;\n           }else if(formData['frequency_type'] == \"Others\" && formData['frequency_string'].trim() == \"\"){\n                isValid = false\n                $('#timings-text').addClass('error');\n            }\n            $('input[name=\"course\"]').removeClass('error');\n    \t\tif($('input[name=\"course\"]').val() == \"\"){\n                $('input[name=\"course\"]').addClass('error');\n                isValid = false;\n            }\n            if(!isValid){\n    \t\t    $('.form-error').removeClass('hidden-xs-up');\n\t\t\t}\n            return isValid;\n        }\n        $(\"#add-prescription\").click(function (evt) {\n            var formData = $(\"#form3\").serializeArray();\n            evt.preventDefault();\n\t\t\t//debugger\n            var data = {};\n            formData.map(function (feild) {\n                data[feild.name] = feild.value;\n            });\n            data.dosage = data.dosage + ' ' + data.dosage_uom;\n             //debugger\n            if(!data.med_dosage_text){\n\n                data.frequency_string = data.morning + '-' + data.afternoon + '-' + data.night;\n                data.frequency_type= \"std_MAE\";\n            }else{\n                data.frequency_string = data.med_dosage_text;\n                data.frequency_type = \"Others\";\n            }\n          // data.frequency = Number(!!data.morning) + '-' + Number(!!data.afternoon) + '-' + Number(!!data.night);\n            data.course = data.course + ' ' + data.duration;\n            data.med_name=data.med_search;\n            if(validateForm(data)){\n                if ($('.form').attr('data-id')) {\n                    data.prescription_id = $('.form').attr('data-id')\n                    prescription_data = prescription_data.filter(function (p) {\n                        return p.prescription_id != data.prescription_id;\n                    })\n                }\n                prescription_data.push(data);\n                showPrescriptions(prescription_data);\n                $('.form').hide();\n\t\t\t}\n            //$(\"#form3\").get(0).reset();\n        });\n        $(\"#save_continue\").on(\"click\", function (evt) {\n            getData.UpdatePrescriptionDetails(appointment_id, prescription_data).then(function (res) {\n                showPrescriptions(res.prescription_details);\n                var next = $('#mytabs li.active').next();\n                next.length ?\n                    next.find('a').click() :\n                    $('#mytabs li a')[2].click();\n            });\n            evt.preventDefault();\n        });\n        $('#tab1').on('click', '.edit', function (ev) {\n            var id = ev.currentTarget.id.split('_')[1];\n            var prescription = prescription_data.filter(function (p) {\n                return p.prescription_id == id\n            });\n            if (prescription.length) {\n                prescription = prescription[0];\n            }\n            $('.form').attr('data-id', prescription.prescription_id);\n            $('#med_search').val(prescription.med_name);\n            $('.med_type_div option[value=\"' + prescription.med_type + '\"]').attr('selected', true);\n            $('.timings #morning').val(prescription.frequency.split('-')[0]);\n            $('.timings #afternoon').val(prescription.frequency.split('-')[1]);\n            $('.timings #night').val(prescription.frequency.split('-')[2]);\n            $('input[name=\"med_dosage_text\"]').val(prescription.med_dosage_text ? prescription.med_dosage_text : '');\n            $('input[name=\"course\"]').val(prescription.course.split(' ')[0]);\n            $('.duration input[value=\"' + prescription.course.split(' ')[1] + '\"]').attr('checked', true);\n            $('input[value=\"' + prescription.med_intake + '\"]').attr('checked', true);\n            $('textarea[name=\"remarks\"]').text(prescription.remarks);\n            $('.form').show();\n        });\n        $('#tab1').on('click', '.delete', function (ev) {\n            var id = ev.currentTarget.id.split('_')[1];\n            if (confirm('Are you sure want to delete this medicine?')) {\n                prescription_data = prescription_data.map(function (p) {\n                    if (p.prescription_id == id) {\n                        p.delete_flag = 'Y';\n                    }\n                    return p;\n                });\n                showPrescriptions(prescription_data);\n            }\n        });\n        $('#free-text-tab').hide();\n        $('#standard').click(function (ev) {\n            $('#standard').addClass('selected');\n            $('#free-text').removeClass('selected');\n\t\t\t$('#standard-tab').show();\n\t\t\t$('#free-text-tab').hide();\n        });\n        $('#free-text').click(function (ev) {\n            $('#free-text').addClass('selected');\n            $('#standard').removeClass('selected')\n            $('#standard-tab').hide();\n            $('#free-text-tab').show();\n        });\n        $('.timings .fa-plus').on('click', function (ev) {\n\t\t\tvar target = $(this).attr('for')\n\t\t\tvar currentValue = $('#'+target).val();\n\t\t\tcurrentValue = !!currentValue ? Number(currentValue) : undefined;\n\t\t\tif(currentValue){\n\t\t\t    currentValue+=prescription.baseQuantity;\n\t\t\t}else{\n\t\t\t    currentValue=prescription.baseQuantity;\n\t\t\t}\n            $('#'+target).val(currentValue);\n\t\t\tev.stopPropagation();\n        });\n        $('.timings .fa-minus').on('click', function (ev) {\n            var target = $(this).attr('for')\n            var currentValue = $('#'+target).val();\n            currentValue = !!currentValue ? Number(currentValue) : undefined;\n            if(currentValue){\n                currentValue-=prescription.baseQuantity;\n            }else{\n                currentValue=prescription.baseQuantity;\n            }\n            $('#'+target).val(currentValue);\n            ev.stopPropagation();\n        });\n        $('#suggestions a').on('click', function (ev) {\n            var text = $(this).text();\n\t\t\t$('#timings-text').text(text);\n        })\n    })\n        /*\t$(\"#autocomplete\").autocomplete(function (evt) {\n                getData.getMymedicineList(med);\n                evt.preventDefault();\n            });\n    */\n            /*$(\"#autocomplete\").autocomplete(function(evt){\n                debugger\n                var formData=$(\"#autocomplete\").serializeArray();\n                var data={};\n                formData.map(function(feild){\n                    data[feild.name]=feild.value;\n                });\n                medicine_data.push(data);\n                getData.getMymedicineList(medicine_data);\n                evt.preventDefault();\n            });*/\n</script>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- components/prescription.html	(date 1513434876000)
+++ components/prescription.html	(date 1513574184000)
@@ -4,7 +4,7 @@
 	<tr>
 		<td>{{med_type}}</td>
 		<td>{{med_name}}</td>
-		<td>{{frequency_string}}</td>
+		<td>{{frequency}}</td>
 		<td>{{course}}</td>
 		<td>{{med_intake}}</td>
 		<td>{{remarks}}</td>
@@ -36,7 +36,7 @@
 				</div>
 				<div class="col-8">
 					<div class="ui-front">
-						<input class="form-input" name="med_search" id="med_search" placeholder="medecin name *" required>
+						<input class="form-input" name="med_search" id="med_search" placeholder="medecin name" required>
 
 						</input>
 					</div>
@@ -56,24 +56,24 @@
 				<div id="standard-tab">
 					<div class="row">
 						<div class="col-2">
-							<div class="font-12">Morning *</div>
-							<i class="fa fa-plus" aria-hidden="true" for="morning"></i>
-								<input type="number" name="morning" id="morning"  class="quantity form-input" value="0" min="0">
-							<i class="fa fa-minus" aria-hidden="true" for="morning"></i>
+                            <div class="font-12">Morning</div>
+                            <i class="fa fa-minus" aria-hidden="true" for="morning"></i>                            
+								<input type="number" name="morning" id="morning"  class="quantity form-input" value="1" min="0.5">
+							<i class="fa fa-plus" aria-hidden="true" for="morning"></i>                            
 							<span class="unit"></span>
 						</div>
 						<div class="col-2">
-							<div class="font-12">Afternoon *</div>
-							<i class="fa fa-plus" aria-hidden="true" for="afternoon"></i>
-							<input type="number" name="afternoon" id="afternoon" placeholder="Afternoon" class="quantity form-input" value="0" min="0">
-							<i class="fa fa-minus" aria-hidden="true" for="afternoon"></i>
+                            <div class="font-12">Afternoon</div>
+                            <i class="fa fa-minus" aria-hidden="true" for="afternoon"></i>                            
+							<input type="number" name="afternoon" id="afternoon" placeholder="Afternoon" class="quantity form-input" value="1" min="0.5">
+							<i class="fa fa-plus" aria-hidden="true" for="afternoon"></i>                            
 							<span class="unit"></span>
 						</div>
 						<div class="col-2">
-							<div class="font-12">Night *</div>
-							<i class="fa fa-plus" aria-hidden="true" for="evening"></i>
-							<input type="number" name="night" id="evening" placeholder="Night" class="quantity form-input" value="0" min="0">
-							<i class="fa fa-minus" aria-hidden="true" for="evening"></i>
+                            <div class="font-12">Night</div>
+                            <i class="fa fa-minus" aria-hidden="true" for="evening"></i>                            
+							<input type="number" name="night" id="evening" placeholder="Night" class="quantity form-input" value="1" min="0.5">
+							<i class="fa fa-plus" aria-hidden="true" for="evening"></i>                            
 							<span class="unit"></span>
 						</div>
 						<div class="col-sm-4 food">
@@ -103,7 +103,7 @@
 			<div class="form-group row mt-3">
 
 				<div class="col-sm-3">
-					<input type="number" name="course" placeholder="Duration *" min=0 class="form-input">
+					<input type="number" name="course" placeholder="Duration" min=0 class="form-input">
 				</div>
 				<div class="col-sm-4 duration">
 					<label class="custom-control custom-radio">
@@ -130,7 +130,7 @@
 			</div>
 
 			<div class="form-group rows">
-				<button class="btn btn-success btn-sm" id="add-prescription">Add</button> <span class="form-error hidden-xs-up">Please add all mandatory fields</span>
+				<button class="btn btn-success btn-sm" id="add-prescription">Add</button>
 
 			</div>
 		</form>
@@ -175,27 +175,7 @@
 	</div>
 
 </div>
-<div class="template modal fade bd-example-modal-lg" id="template-alert" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
-        <div class="template-msg modal-dialog modal-sm" role="document">
-            <div class=" modal-content">
-                <div class="modal-header">
-                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
-                        <span aria-hidden="true">&times;</span>
-                    </button>
-                    <h4 class="modal-title">Template</h4>
-                </div>
-                <div class="modal-body-template">
-                Do you want to replace the existing medicines or append it?
-                </div>
-                <div class="modal-footer text-center">
-                    <button type="button" class="btn btn-info btn-sm" id="replace" data-dismiss="modal" >Replace</button>
-                    <button type="button" class="btn btn-primary btn-sm" id="append" data-dismiss="modal" >Append</button>
-                </div>
-            </div>
-        </div>
-    </div>
 
-</div>
 <script type="text/javascript">
 	var prescription = {}
     $(document).ready(function() {
@@ -232,7 +212,7 @@
             containerCssClass : "custom-select ",
             ajax: { // instead of writing the function to execute the request we use Select2's convenient helper
                 type: "post",
-                url: base_url+"/api/getPrescriptionTemplateList.php",
+                url: base_url+"/wapi/getPrescriptionTemplateList.php",
                 dataType: 'json',
            //     contentType: 'application/json; charset=UTF-8',
                 quietMillis: 250,
@@ -252,7 +232,7 @@
 
                     return {
                         results: $.map(data.template_det, function (smthg) {
-                           return {id: smthg.template_id, text: smthg.template_name}
+                            return {id: smthg.template_id, text: smthg.template_name}
                         })
                     };
                 }
@@ -262,39 +242,11 @@
 
         $('#template_name').on('select2:select', function (e) {
             var template_id = $(this).val();
-              var template_name=$("#template_name").text();         
-            
             getData.getMyprescriptionTemplateDetails(template_id).then(function (res) {
-             
-                $(".modal-header").html(template_name);
-                $('#template-alert').modal({
-                    show: true
-                });
-                $("#replace").on("click", function (evt) {
-                    showPrescriptions(res.prescription_details);
-                    evt.preventDefault();
-                });
-                $("#append").on("click", function (evt) {
-                    //  var prev_data = showPrescriptions(res.prescription_details);
-                    getData.getMyprescriptionTemplateDetails(template_id).then(function (res) {
-                    debugger
-                    prescription_data =prescription_data.concat(res.prescription_details);
-                    showPrescriptions(prescription_data);
-                });
-                evt.preventDefault();
-                });
+                showPrescriptions(res.prescription_details);
+            });
+        });
 
-            });
-        });
-
-/*  Code start for append and replace  */
-
-        
-    
-
-
-
-/*  code end here for append and replace  */
         $("#med_search").autocomplete({
             minLength: 3,
             placeholder: "Search for a template",
@@ -363,67 +315,40 @@
         }
         //  $("#form4").hide()
         showPrescriptions(prescription_data);
+        $("#form3").submit(function (ev) {
+			debugger
+        })
         function validateForm(formData){
-            var isValid = true;
-            $('.form-error').addClass('hidden-xs-up')
-            $('#med_search').removeClass('error');
-           if(formData['med_name'] == ""){
-               $('#med_search').addClass('error');
-               isValid =false;
-           }
-           $('#med_type').removeClass('error');
-            $('.quantity').removeClass('error');
-            $('#timings-text').removeClass('error');
-
-            if(formData['frequency_type'] == "std_MAE" && formData['frequency_string'] == "0-0-0"){
-                $('.quantity').addClass('error');
-                isValid = false;
-           }else if(formData['frequency_type'] == "Others" && formData['frequency_string'].trim() == ""){
-                isValid = false
-                $('#timings-text').addClass('error');
-            }
-            $('input[name="course"]').removeClass('error');
-    		if($('input[name="course"]').val() == ""){
-                $('input[name="course"]').addClass('error');
-                isValid = false;
-            }
-            if(!isValid){
-    		    $('.form-error').removeClass('hidden-xs-up');
-			}
-            return isValid;
+           formData.map(function(field){
+               if(field.value == ""){
+                   if(field.name == "med_type"){
+                       $('#med_type').addClass('error')
+                   }
+               }
+           })
         }
         $("#add-prescription").click(function (evt) {
             var formData = $("#form3").serializeArray();
             evt.preventDefault();
-			//debugger
-            var data = {};
+			var data = {};
             formData.map(function (feild) {
                 data[feild.name] = feild.value;
             });
+            validateForm(formData);
             data.dosage = data.dosage + ' ' + data.dosage_uom;
-             //debugger
-            if(!data.med_dosage_text){
-
-                data.frequency_string = data.morning + '-' + data.afternoon + '-' + data.night;
-                data.frequency_type= "std_MAE";
-            }else{
-                data.frequency_string = data.med_dosage_text;
-                data.frequency_type = "Others";
-            }
-          // data.frequency = Number(!!data.morning) + '-' + Number(!!data.afternoon) + '-' + Number(!!data.night);
+            data.frequency = Number(!!data.morning) + '-' + Number(!!data.afternoon) + '-' + Number(!!data.night);
             data.course = data.course + ' ' + data.duration;
             data.med_name=data.med_search;
-            if(validateForm(data)){
-                if ($('.form').attr('data-id')) {
-                    data.prescription_id = $('.form').attr('data-id')
-                    prescription_data = prescription_data.filter(function (p) {
-                        return p.prescription_id != data.prescription_id;
-                    })
-                }
-                prescription_data.push(data);
-                showPrescriptions(prescription_data);
-                $('.form').hide();
-			}
+            if ($('.form').attr('data-id')) {
+                data.prescription_id = $('.form').attr('data-id')
+                prescription_data = prescription_data.filter(function (p) {
+                    return p.prescription_id != data.prescription_id;
+                })
+            }
+            prescription_data.push(data);
+            showPrescriptions(prescription_data);
+            $('.form').hide();
+            $("#form3").submit();
             //$("#form3").get(0).reset();
         });
         $("#save_continue").on("click", function (evt) {
@@ -459,15 +384,13 @@
         });
         $('#tab1').on('click', '.delete', function (ev) {
             var id = ev.currentTarget.id.split('_')[1];
-            if (confirm('Are you sure want to delete this medicine?')) {
-                prescription_data = prescription_data.map(function (p) {
-                    if (p.prescription_id == id) {
-                        p.delete_flag = 'Y';
-                    }
-                    return p;
-                });
-                showPrescriptions(prescription_data);
-            }
+            prescription_data = prescription_data.map(function (p) {
+                if (p.prescription_id == id) {
+                    p.delete_flag = 'Y';
+                }
+                return p;
+            });
+            showPrescriptions(prescription_data);
         });
         $('#free-text-tab').hide();
         $('#standard').click(function (ev) {
Index: js/dashboard.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>var appointment_id, hs_id,appointment_list,sessionId,token,apiKey,next_apmt_date,prev_apmt_date,apmt_status,prescriptions_list, summary_details;\nvar appointment,apmt_type,consultation_id,record_id;\nvar showToaster, session;\nvar doctor_id, doctor_name,doc_photo, hcc_id, template_id, login_token, appointment_date;\n//var apiKey = \"45638452\";\nfunction showMessage(message) {\n    $('#subscriber').html(\"<div class='message'><div class='text'>\"+ message +\"</div></div>\");\n}\nfunction showLoader() {\n    $('.loading').removeClass('hidden-xs-up');\n}\nfunction hideLoader() {\n    $('.loading').addClass('hidden-xs-up');\n}\n$(document).ready(function(){\n\tvar actualDate=new Date();\n    var date=moment(actualDate).format(\"YYYYMMDD\");\n    getData.getDashboardData(date).then(function(res){\n        $('#filter').load('./components/filter.html');\n        appointment_list=res.appointments_details.appointment;\n\n    \tshowDashboardDetails(res);\n    \tappointment_date=moment(actualDate).format(\"YYYY-MM-DD\");\n\n\t});\n\n\t/*getting appointment details*/\n\tvar getAppointmentDetails = function(ev){\n\t\tappointment_id = ev.currentTarget.id;\n\t\tgetData.getAppointmentDetails(appointment_id).then(function(res){\n\t\t    $('.no-appointment-selected').addClass('d-none');\n\n\t\t    $('.appointment-info').removeClass('d-none');\n\t\t    var source = $('#detailsTemplate').html();\n            var template = Handlebars.compile(source);\n            var html = template(res.appointments_details);\n            $('#details').html(html);\n            $('#prescription').load('./components/prescription.html');\n          //  $('#newprescription').load('./components/newprescription.html');\n          if(res.appointments_details.appointment_det.health_record.length == 0){\n                $('.attach-docs').hide();\n          }\n\n\t\t\tif(res.appointments_details.appointment_det.apmt_type != \"VC\"){\n\t\t\t\t$('#start-vedio-consultation').hide();\n\t\t\t}else{\n                $('#start-vedio-consultation').show();\n\t\t\t}\n            hs_id = res.appointments_details.health_seeker_profile.hs_id;\n\t\t\t$(\"#start-vedio-consultation\").on(\"click\",function (vid) {\n\t\t\t\tgetData.startVideoConsultation(appointment_id,hs_id).then(function (res) {\n                    sessionId=res.video_session_det.session;\n                    token=res.video_session_det.token;\n                    apiKey=res.video_session_det.apiKey;\n                    startVedio();\n                });\n\t\t\t\tvid.preventDefault();\n\n            });\n            $(\".health_record\").on(\"click\", function (evt) {\n                getData.getDocumentBlobData(hs_id).then(function (res) {\n                \tvar data=res.document.doc_data;\n                    var objbuilder = '';\n                    objbuilder += ('<object width=\"100%\" height=\"100%\" data=\"data:application/pdf;base64,');\n                    objbuilder += (data);\n                    objbuilder += ('\" type=\"application/pdf\" class=\"internal\">');\n                    objbuilder += ('<embed src=\"data:application/pdf;base64,');\n                    objbuilder += (data);\n                    objbuilder += ('\" type=\"application/pdf\"  />');\n                    objbuilder += ('</object>');\n                    $('.modal-body').html(objbuilder);\n                    $(\".document-title\").html(res.document.doc_desc);\n\n\n                    //to open pdf in new tab\n                   /* var win = window.open(\"#\",\"_blank\");\n                    var title = \"my tab title\";\n                    win.document.write('<html><title>'+ title +'</title><body style=\"margin-top:0px; margin-left: 0px; margin-right: 0px; margin-bottom: 0px;\">');\n                    win.document.write(objbuilder);\n                    win.document.write('</body></html>');\n                    layer = jQuery(win.document);*/\n                });\n\t\t\tevt.preventDefault();\n            });\n\n\n            apmt_status=res.appointments_details.appointment_det.apmt_status;\n            prescriptions_list=res.appointments_details.consultation_details.prescription_details;\n            summary_details=res.appointments_details.consultation_details.consultation_summary;\n            appointment=res.appointments_details;\n            consultation_id=summary_details.consultation_id;\n            $('#prescription').load('./components/prescription.html');\n          //  $('#newprescription').load('./components/newprescription.html');\n            $('#summary').load('./components/summary.html');\n\n\n        });\n\t};\n\tshowDashboardDetails=function(res){\n\t\tif(res.appointments_details.appointment_summary)\n\t\t{\n            $('#all_button').text(res.appointments_details.appointment_summary.total);\n            $('#pending_button').text(res.appointments_details.appointment_summary.pending);\n            $('#closed_button').text(res.appointments_details.appointment_summary.missed);\n        }\n       // $('#shcedule-date').text(res.appointments_details.appointment[0].appointment_date);\n        var source   = $(\"#appointmentTemplate\").html();\n        var template = Handlebars.compile(source);\n\n        var html = template(res.appointments_details);\n\n        if($(window).width() < 500){\n            $('#appointment-list-phone').html(html);\n            $('#appointment-list-phone').removeClass('list-group').addClass('list-inline');\n            $('#appointment-list-phone .list-group-item').removeClass('list-group-item').addClass('list-inline-item')\n        }else{\n            $('#appointment-list').html(html)\n        }\n        next_apmt_date=res.appointments_details.next_appointment_date;\n        prev_apmt_date=res.appointments_details.prev_appointment_date;\n      //  hcc_id=res.appointment_details.appointments[0].hcc_det.hcc_id;\n\t\t$(\".PC\").html('<i class=\"fa fa-user\"></i>');\n        $(\".VC\").html('<i class=\"fa fa-video-camera\"></i>');\n    };\n\tvar addPrescription = function(ev){\n\n\t};\n\n\t// Handling all of our errors here by alerting them\n\tfunction handleError(error) {\n\t  if (error) {\n\t    alert(error.message);\n\t  }\n\t}\n    var publisher, subscriber;\n    function initializeSession(apiKey, sessionId, token) {\n        showMessage(\"Checking for the Support ans system requirements\");\n        try{\n\n        OT.addEventListener(\"exception\", exceptionHandler);\n        if(OT.checkSystemRequirements()){\n            session = OT.initSession(apiKey, sessionId);\n            session.on('streamCreated', function(event) {\n                if(!publisherError){\n                    $('#subscriber').html(\"<div id='subscriber-container'></div>\");\n                    subscriber = session.subscribe(event.stream, 'subscriber-container', {\n                        width: '100%',\n                        height: '100%',\n                        showControls: false,\n                    }, handleSubscriberError);\n                    subscriber.on('connected', function (event) {\n                    });\n                    subscriber.on('streamDestroyed', subscriberStreamDestroyed);\n                }else{\n                    showMessage(\"<span>\"+current_appointment_details.health_seeker_profile.hs_name+\" has joined the call but, App does not have access to Camera and Microphone. Please allow access to Camera ans Microphone.</span><br/>\" +\n                        \"Fix : <a href='https://support.google.com/chrome/answer/2693767?hl=en'>Google chrome</a>, <a href='https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0ahUKEwiovJWr-tnXAhVIpZQKHSD8CPIQFggnMAE&url=https%3A%2F%2Fhelp.seesaw.me%2Fhc%2Fen-us%2Farticles%2F207891173-How-to-give-camera-mic-and-push-notifications-permissions-to-Seesaw&usg=AOvVaw2gUF7tM_fORFNgkbFoQkBv'>Firefox</a> \" +\n                        \"<br/>>Please reload the app after access us given.\");\n                }\n\n            });\n            session.on('sessionDisconnected', function (event) {\n                if (event.reason === 'networkDisconnected') {\n                    event.preventDefault();\n                    // var subscribers = session.getSubscribersForStream(event.stream);\n                    // if (subscribers.length > 0) {\n                    //     var subscriber = document.getElementById(subscribers[0].id);\n                    //     // Display error message inside the Subscriber\n                    //     subscriber.innerHTML = 'Lost connection. This could be due to your internet connection '\n                    //         + 'or because the other party lost their connection.';\n                    //     event.preventDefault();   // Prevent the Subscriber from being removed\n                    // }\n                    showMessage('Lost connection. This could be due to your internet connection '\n                        + 'or because the other party lost their connection.');\n                    event.preventDefault();\n                }\n            });\n            session.on(\"streamDestroyed\", sessionStreamDestroyed);\n            // Create a publisher\n            $('#publisher').html(\"<div id='publisher-container'></div>\");\n            publisher = OT.initPublisher('publisher-container', {\n                insertMode: 'append',\n                width: '100%',\n                height: '100%',\n                showControls: false,\n            }, handleInitiatePublisherError);\n            publisher.on('streamDestroyed', publisherStreamDestroyed);\n            $('#publisher').draggable();\n            // Connect to the session\n            session.connect(token, function(error) {\n                // If the connection is successful, publish to the session\n                if (error) {\n                    handleConnectionError(error);\n                } else if(!publisherError){\n                    session.publish(publisher, handlePublishComplete);\n                }\n            });\n            $('.appointment-list-container').addClass('hidden-xs-up');\n            $('.video-container').removeClass('hidden-xs-up');\n            $('.left-container').removeClass('col-3').addClass('col-5');\n            $('.appointment-content').removeClass('col-9').addClass('col-7');\n            $($('.video-container')[0]).scrollTop(200);\n            $('#start-vedio-consultation').addClass('hidden-xs-up');\n            $('#close-vedio-consultation').removeClass('hidden-xs-up');\n            return {session: session, stream: publisher.stream};\n        }else{\n            showMessage(\"your browser does not support webRTC please upgrade your browser\");\n        }}catch (e){\n            debugger\n            console.error(e)\n        }\n    }\n    var vedioSession;\n    var startVedio = function(){\n        apiKey = apiKey,\n            sessionId = sessionId,\n            token = token,\n            // (optional) add server code here\n            vedioSession = initializeSession(apiKey, sessionId, token);\n    };\n    var stopVideo = function(){\n        if(confirm(\"Do You really want to close the session ? \")){\n            if(session){\n\n                session.disconnect()\n                $('.video-container').addClass('hidden-xs-up');\n                $('.left-container').removeClass('col-12').removeClass('col-5').addClass('col-3');\n                $('.appointment-list-container').removeClass('hidden-xs-up');\n                $('.appointment-content').removeClass('hidden-xs-up').removeClass('col-7').addClass('col-9');\n                $('#start-vedio-consultation').removeClass('hidden-xs-up');\n                $('#close-vedio-consultation').addClass('hidden-xs-up');\n                $('.audio, .video, .full-screen, .full-screen-off').addClass('hidden-xs-up');\n            }\n        }\n    };\n    var muteAudio = function(ev){\n        if($(this).hasClass('muted')){\n            publisher.publishAudio(true);\n            $(this).removeClass('muted');\n        }else{\n            publisher.publishAudio(false);\n            $(this).addClass('muted');\n        }\n    }\n    var muteVideo = function(ev){\n        if($(this).hasClass('muted')){\n            publisher.publishVideo(true);\n            $(this).removeClass('muted');\n        }else{\n            publisher.publishVideo(false);\n            $(this).addClass('muted');\n        }\n    }\n    var showFullScreen = function(ev){\n        if(!$('#publisher').hasClass('hidden-xs-up')){\n            $('.appointment-content').addClass('hidden-xs-up');\n            $('.left-container').addClass('col-12').removeClass('col-3');\n        }else if(!$('#subscriber').hasClass('hidden-xs-up')){\n            $('#subscriber').addClass('show-full-screen');\n        }\n        $('.full-screen-off').removeClass('hidden-xs-up')\n        $('.full-screen').addClass('hidden-xs-up')\n    }\n    var removeFullScreen = function (ev) {\n        if(!$('#publisher').hasClass('hidden-xs-up')){\n            $('.appointment-content').removeClass('hidden-xs-up');\n            $('.left-container').addClass('col-3').removeClass('col-12');\n        }else if(!$('#subscriber').hasClass('hidden-xs-up')){\n            $('#subscriber').removeClass('show-full-screen');\n        }\n        $('.full-screen').removeClass('hidden-xs-up')\n        $('.full-screen-off').addClass('hidden-xs-up')\n    }\n    showToaster = function (message) {\n        var x = $('#toaster');\n\n        // Add the \"show\" class to DIV\n        x.html(message);\n        x.addClass(\"show\");\n\n\n        // After 3 seconds, remove the show class from DIV\n        setTimeout(function(){ x.removeClass(\"show\"); x.html('')}, 1000);\n    }\n    //function getDocument() {\n    //\tdebugger;\n\n\n\n    function showProfile() {\n\n    }\n    $(\"#appointment-list\").on(\"click\", function (evt) {\n        var next = $('#mytabs li.active').next();\n        next.length?\n            next.find('a').click():\n            $('#mytabs li a')[0].click();\n\n    });\n    $('#appointment-list, #appointment-list-phone').on('click touchstart', '.appointment',getAppointmentDetails);\n    $('.appointment-details #prescription').on('submit', addPrescription);\n    //$('#start-vedio-consultation').on('click', startVedio)\n    $('#close-vedio-consultation').on('click', stopVideo);\n    $('#toggleLocalAudio').on('click', muteAudio);\n    $('#toggleLocalVideo').on('click', muteVideo);\n    $('.full-screen').on('click', showFullScreen);\n    $('.App-control-container').on('click', '.full-screen-off', removeFullScreen);\n    $('#appointment-list').on('click', '.heath-seeker-profile', showProfile);\n    //$('.health_record').on('click', getDocument);\n\n    $('#logout').on('click', logout);\n    $('#api-error').on(\"click\", '.fa-times', function (ev) {\n        hideApiError();\n    });\n});\nfunction logout() {\n\n       getData.doDoctorLogout().then(function (res) {\n            isLoggedIn = false;\n            window.location = '/';\n\n            delete sessionStorage.userId;\n            delete sessionStorage.doctorId;\n            location.reload();\n            // sessionStorage.removeItem(\"id\");\n            // sessionStorage.removeItem(\"name\");\n            // sessionStorage.removeItem(\"token\");\n            // sessionStorage.removeItem(\"photo\");\n            //\n            // doctor_id=sessionStorage.getItem(\"id\");\n            // doctor_name=sessionStorage.getItem(\"name\");\n            // login_token=sessionStorage.getItem(\"token\");\n            // doc_photo=sessionStorage.getItem(\"photo\");\n            //  console.log(doctor_id+\" \"+doctor_name+\" \"+login_token);\n        });\n\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- js/dashboard.js	(date 1513434876000)
+++ js/dashboard.js	(date 1513436143000)
@@ -13,7 +13,8 @@
     $('.loading').addClass('hidden-xs-up');
 }
 $(document).ready(function(){
-	var actualDate=new Date();
+    var filter1 = "booked", filter2;
+    var actualDate=new Date();
     var date=moment(actualDate).format("YYYYMMDD");
     getData.getDashboardData(date).then(function(res){
         $('#filter').load('./components/filter.html');
@@ -58,7 +59,7 @@
 
             });
             $(".health_record").on("click", function (evt) {
-                getData.getDocumentBlobData(hs_id).then(function (res) {
+                getData.getDocumentBlobData(hs_id, evt.currentTarget.id).then(function (res) {
                 	var data=res.document.doc_data;
                     var objbuilder = '';
                     objbuilder += ('<object width="100%" height="100%" data="data:application/pdf;base64,');
@@ -320,6 +321,7 @@
 
             delete sessionStorage.userId;
             delete sessionStorage.doctorId;
+            delete sessionStorage.token;
             location.reload();
             // sessionStorage.removeItem("id");
             // sessionStorage.removeItem("name");
Index: js/getData.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>var session_info = {\n    \"user_id\": sessionStorage.getItem(\"userId\"),\n    \"access_token\": sessionStorage.getItem(\"token\"),\n    \"device_id\": \"web\",\n    \"doctor_id\": sessionStorage.getItem(\"doctorId\")\n};\nvar doctor_id = sessionStorage.getItem(\"doctorId\");\nvar base_url = \"https://52.66.157.195/growayu/ganewdesign/\"           //Test Server\n//var base_url = \"https://52.77.171.116/gadoctor\";                        //Stage Server\nvar getData = {\n    getDashboardData: function(date){\n        var url = \"/api/getDocAppointmentDashboard.php\";\n        var apmt_input = {\n            \"date\" : date,\n            \"doctor_id\" : doctor_id,\n            \"hcc_id\" : \"1\"\n        };\n        var data = {\n            appntment_input: apmt_input,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url+url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    getAppointmentDetails: function(id){\n        var url = \"/api/getAppointmentDetails.php\";\n        var doctorId = \"1\";\n        var apmt_input= {\n            apmt_id : id,\n            doctor_id :doctorId,\n            hcc_id : \"1\"\n        }\n        var data = {\n            apmt_input: apmt_input,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url+url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    doDoctorLogin: function(username,password){\n        var url = \"/api/doDoctorLogin.php\";\n        var doctor_info = {\n            \"doctor_email\": username,\n            \"doctor_pwd\": password,\n            \"location\": {\n                \"latitude\": \"\",\n                \"langitude\": \"\"\n            },\n            \"device_id\": \"web\",\n        };\n        var data = {\n            doctor_info: doctor_info\n        };\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url+url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            return res;\n        });\n        return call;\n    },\n    doDoctorLogout: function(){\n        var url = \"/api/doDoctorLogout.php\";\n        var login_info = {\n            \"session_token\" : login_token,\n            \"sessionId\" : \"\",\n            \"doctor_id\" : doctor_id,\n            \"device_id\": \"\"\n        };\n        var data = {\n            login_info : login_info,\n            session_info: session_info\n        };\n        showLoader();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url+url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                 //showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    startVideoConsultation: function(id,hs_id){\n        var url = \"/api/startVideoConsultation.php\";\n        var apmt_info = {\n            \"hcc_id\" : \"1\",\n            \"doctor_id\" : doctor_id,\n            \"apmt_id\" : id,\n            \"health_seeker_id\" : hs_id,\n            \"date\" : \"\"\n        };\n        var data = {\n            apmt_info: apmt_info,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url+url,\n            data: JSON.stringify(data),\n           dataType: 'json',\n            success: function (res,status) {\n                 showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    UpdatePrescriptionDetails: function (id,prescriptions) {\n        var url = \"/api/UpdatePrescriptionDetails.php\";\n        var doctorId = doctor_id;\n\n        var apmt_input = {\n            apmt_id: id,\n            doctor_id: doctorId,\n            hs_id: hs_id,\n            hcc_id: \"1\"\n        };\n\n        var data = {\n            apmt_input: apmt_input,\n            prescription: prescriptions,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res, status){\n                 showApiError(res.error);\n                // alert(\"success update pres\");\n                return res;\n\n            },\n            error: function (err, status) {\n                console.error(err);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n\n        return call;\n    },\n    UpdateConsultationSummary: function(id,summary){\n        var url = \"/api/UpdateConsultationSummary.php\";\n        var doctorId = doctor_id;\n        var apmt_input = {\n            apmt_id: id,\n            doctor_id: doctorId,\n            hs_id: hs_id,\n            hcc_id: \"1\"\n        };\n        /* var summary={\n             consultation_id: \"\",\n             diagnosis:\"pain in chest\",\n             mgmt_plan:\"hello\",\n             followup_date:\"20-12-2017\",\n             followup_in: \"2 days\",\n             waiver_status: \"Partial\",\n             waived_amount: \"1000\",\n             ga_notes: \"bye\",\n             doctor_notes: \"hi there\",\n             suggested_test: [\n                 {\n                     test_id: \"1\",\n                     test_name: \"Blood\"\n                 },\n                 {\n                     test_id: \"2\",\n                     test_name: \"Chemo\"\n                 }\n             ],\n             seeker_instructions: [\n                 {\n                     instruction_id: \"\",\n                     instruction_text: \"\"\n                 }\n             ]\n         };*/\n\n\n        var data = {\n            apmt_input: apmt_input,\n            summary:summary,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                //alert(\"success in update summary\");\n                 showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                //alert(\"error in update summary\");\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    previewConsultationSummary: function(id){\n        var url = \"/api/previewConsultationSummary.php\";\n        var doctorId = doctor_id;\n        var apmt_input = {\n            apmt_id: id,\n            doctor_id: doctorId,\n            hcc_id: \"\",\n            date: \"\"\n        };\n        var data = {\n            apmt_input: apmt_input,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                 showApiError(res.error);\n                //  alert(\"success in preview summary\");\n\n                return res;\n            },\n            error: function(err,status){\n                // alert(\"error in preview summary\");\n                console.error(err, status);\n            }\n        }).then(function(res){\n            hideLoader();\n            return res;\n        });\n        return call;\n    },\n    getMymedicineList: function(term){\n        var url = \"/api/getMymedicineList.php\";\n        var doctorId = \"1\";\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify({\n                medicine_list: {\n                    doctor_id: doctorId,\n                    //doctor_id:1,\n                    med_name: term\n                },\n                session_info: session_info\n            }),\n            dataType: 'json',\n            success: function (res) {\n                //   alert(\"success in med\");\n                showApiError(res.error)\n                return res;\n            },\n            error: function(err,status){\n                //  alert(\"error in med\");\n                console.error(err, status);\n            }\n        });\n        return call;\n    },\n    getPrescriptionTemplateList: function(term){\n        var url = \"/api/getPrescriptionTemplateList.php\";\n        var doctorId = doctor_id;\n        hideApiError();\n        call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data:JSON.stringify({\n                template_input : {\n                    doctor_id: doctorId,\n                    //doctor_id: 1,\n                    template_id: 1,\n                    template_name:term,\n                    speciality: \"\"\n                }\n            }),\n            dataType: 'json',\n            success: function (res,status) {\n                 showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            return res;\n        });\n        return call;\n    },\n    getMyprescriptionTemplateDetails: function(id){\n        var url = \"/api/getMyprescriptionTemplateDetails.php\";\n        var doctorId = doctor_id;\n        var template_input = {\n            doctor_id: doctorId,\n            template_id: id,\n        };\n        var data = {\n            template_input: template_input,\n            session_info: session_info\n        }\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                 showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        }).then(function(res){\n            return res;\n        });\n        return call;\n    },\n\n    /* getDoctorProfile: function(id){\n         var url = \"/wapi/getDoctorProfile.php\";\n         var doctorId = id;\n         var hcc_id=\"1\";\n         var doctor_info = {\n             doctor_id: doctorId,\n             hcc_id: hcc_id\n         };\n         var data = {\n             doctor_info: doctor_info,\n             session_info: session_info\n         }\n         var call = $.ajax({\n             type: \"POST\",\n             url: base_url + url,\n             data: JSON.stringify(data),\n             dataType: 'json',\n             success: function (res,status) {\n                 return res;\n             },\n             error: function(err,status){\n                 console.error(err, status);\n             }\n         }).then(function(res){\n             return res;\n         });\n         return call;\n     }, */\n    closeConsultation: function (id) {\n        var url = \"/api/closeConsultation.php\";\n        var doctorId = doctor_id;\n        var date=appointment_date;\n        var apmt_input = {\n            apmt_id: id,\n            doctor_id: doctorId,\n            hcc_id:\"1\",\n            date: date\n        };\n        var data = {\n            apmt_input: apmt_input,\n            session_info: session_info\n        };\n        showLoader();\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res,status) {\n                 showApiError(res.error);\n                return res;\n            },\n            error: function(err,status){\n                console.error(err, status);\n            }\n        });\n        return call;\n    },\n    getDocumentBlobData: function (id) {\n        var url = \"/api/getDocumentBlobData.php\";\n        var hs_id = id;\n        var record_id=441;\n        var document = {\n            hs_id:hs_id,\n            record_id:record_id\n        };\n        var data = {\n            document: document,\n            session_info: session_info\n        };\n        hideApiError();\n        var call = $.ajax({\n            type: \"POST\",\n            url: base_url + url,\n            data: JSON.stringify(data),\n            dataType: 'json',\n            success: function (res, status){\n               // alert(\"success in blob\");\n                showApiError(res.error);\n                return res;\n            },\n            error: function (err, status) {\n                alert(\"error in blob\");\n                console.error(err, status);\n            }\n        });\n        return call;\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- js/getData.js	(date 1513434876000)
+++ js/getData.js	(date 1513436143000)
@@ -453,10 +453,10 @@
         });
         return call;
     },
-    getDocumentBlobData: function (id) {
+    getDocumentBlobData: function (id, rec_id) {
         var url = "/api/getDocumentBlobData.php";
         var hs_id = id;
-        var record_id=441;
+        var record_id=rec_id;
         var document = {
             hs_id:hs_id,
             record_id:record_id
